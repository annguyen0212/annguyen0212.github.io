<!DOCTYPE html>
<html>
  <head>
    <title>Experiment</title>
    <script src="jspsych.js"></script>
    <script src="plugins/jspsych-html-button-response.js"></script>
    <script src="plugins/jspsych-image-button-response.js"></script>
    <script src="plugins/jspsych-audio-button-response.js"></script>


    <link href="css/jspsych.css" rel="stylesheet" type="text/css"></link>
  </head>
  <body>  
  </body>
  <script>
   var timeline = [];
   var welcome = {
      type: "html-button-response",
      choices: ['Continue'],
      stimulus: "<p> Welcome to the experiment! <br> Today you are going to watch the adventure of Billy and Julie. Please make sure you are able to hear audio before proceeding. To move onto the next screen throughout the story, click Continue.<p>"
    };
    
   var welcome2 = {
      type: "audio-button-response",
      stimulus:  'sound/welcome.wav',
      choices: ['Play Again', 'Continue'],
      prompt: "This is Beeple. He will be listening to the story along with you. However, he occasionally has to interrupt the story to ask questions, either because he doesn't hear what the narrator says (his English is bad!) or because he misses some details on the screen. Please help Beeple answer his questions! <img class='center-fit' src='image/alien.jpg'> "
    };
      
    var slide1 = {   
       type: 'audio-button-response',
     stimulus: 'sound/1.wav',
      prompt: "<img class='center-fit' src='image/2.gif'> ",
    choices: ['Play Again', 'Continue'],
  
};
      
      var repeat1 = {
  timeline: [slide1],
  
  loop_function: function(){
    data = jsPsych.data.getLastTrialData().values()[0]
      console.log(data._button_pressed)
    if(data.button_pressed == "0"){
      return true; // loop again!
    } else {
      return false; // continue
    }
  }
}
      
      var repeat2 = {
  timeline: [{   
       type: 'audio-button-response',
     stimulus: 'sound/2.wav',
      prompt: "<img class='center-fit' src='image/2.jpg'> ",
    choices: ['Play Again', 'Continue'],
  
}],
  
  loop_function: function(){
    data = jsPsych.data.getLastTrialData().values()[0]
      console.log(data._button_pressed)
    if(data.button_pressed == "0"){
      return true; // loop again!
    } else {
      return false; // continue
    }
  }
}
    
        
         
       var repeat17 = {
  timeline: [{   
       type: 'html-button-response',
     stimulus: '',
      prompt: '<img src="image/17.jpg">',
    choices: ['Play Again', 'Continue'],
  enable: true,
}],
  
  loop_function: function(){
    data = jsPsych.data.getLastTrialData().values()[0]
      console.log(data._button_pressed)
    if(data.button_pressed == "0"){
      return true; // loop again!
    } else {
      return false; // continue
    }
  }
}
  

   var q2 = {
       type: 'html-button-response',
     stimulus: "<img class='center-fit' src='image/alien.jpg'> ",
    choices: ['t1', 't2'],
  
}
   

    id=  Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 5);
String.prototype.format = function () {
    var i = 0, args = arguments;
    return this.replace(/{}/g, function () {
        return typeof args[i] != 'undefined' ? args[i++] : '';
    });
    };
      
      jsPsych.init({
      timeline: timeline,
         use_webaudio: false,
     fullscreen: true,
      on_finish: function(){ saveData("experiment_data", jsPsych.data.get().csv()); 
                           jsPsych.data.get().localSave('csv','{}.csv'.format(id));}
    });
  </script>
</html>
